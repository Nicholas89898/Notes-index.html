<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Offline Journal</title>
<style>
body { margin:0; font-family:sans-serif; background:#121212; color:#eee; }
#tabBar { display:flex; gap:5px; padding:10px; flex-wrap:wrap; }
.tab { background:#333; padding:5px 8px; border-radius:4px; cursor:pointer; }
.tab.active { background:#007acc; }
button { background:#222; color:#eee; border:none; padding:6px; border-radius:4px; cursor:pointer; }
textarea { width:95%; height:300px; background:#222; color:#eee; border:none; padding:10px; margin:10px; resize:none; }
</style>
</head>
<body>

<div id="tabBar"></div>
<button onclick="addTab()">+ Tab</button>
<button onclick="deleteTab()">Delete Tab</button>
<textarea id="editor" oninput="saveEditor()"></textarea>

<script>
let journal = JSON.parse(localStorage.getItem('journal')||'{"tabs":["Journal"],"active":"Journal","Journal":""}');
const tabBar = document.getElementById("tabBar");
const editor = document.getElementById("editor");

function renderTabs(){
  tabBar.innerHTML="";
  journal.tabs.forEach(t=>{
    const div=document.createElement("div");
    div.className="tab"+(journal.active===t?" active":"");
    div.textContent=t;
    div.onclick=()=>openTab(t);
    tabBar.appendChild(div);
  });
  editor.value = journal[journal.active] || "";
}

function openTab(name){
  saveCurrent();
  journal.active=name;
  editor.value = journal[name] || "";
  renderTabs();
}

function addTab(){
  const name="Tab "+(journal.tabs.length+1);
  journal.tabs.push(name);
  journal[name]="";
  journal.active=name;
  renderTabs();
  saveJournal();
}

function deleteTab(){
  if(!journal.active) return;
  const idx = journal.tabs.indexOf(journal.active);
  if(idx!==-1) journal.tabs.splice(idx,1);
  delete journal[journal.active];
  journal.active = journal.tabs[0] || null;
  renderTabs();
  saveJournal();
}

function saveCurrent(){ if(journal.active) journal[journal.active]=editor.value; }
function saveEditor(){ saveCurrent(); saveJournal(); }
function saveJournal(){ localStorage.setItem('journal', JSON.stringify(journal)); }

renderTabs();
</script>

</body>
</html>
